<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Tablix Name="table1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.6875in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.67708in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.79167in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.21875in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.22in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox2">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Ano/Mês</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox2</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox3">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Filial</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox3</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox4">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Chamados Abertos</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox4</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox5">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Chamados Fechados</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox5</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox6">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Atendimentos</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox6</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.21in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="AnoMes">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!AnoMes.Value</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>AnoMes</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Filial">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Filial.Value</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Filial</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="ChamadosAbertos">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!ChamadosAbertos.Value</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>ChamadosAbertos</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="ChamadosFechados">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!ChamadosFechados.Value</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>ChamadosFechados</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Atendimentos">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Atendimentos.Value</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Atendimentos</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>DimGray</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <KeepWithGroup>After</KeepWithGroup>
              <RepeatOnNewPage>true</RepeatOnNewPage>
              <KeepTogether>true</KeepTogether>
            </TablixMember>
            <TablixMember>
              <Group Name="table1_Details_Group">
                <DataElementName>Detail</DataElementName>
              </Group>
              <TablixMembers>
                <TablixMember />
              </TablixMembers>
              <DataElementName>Detail_Collection</DataElementName>
              <DataElementOutput>Output</DataElementOutput>
              <KeepTogether>true</KeepTogether>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DataSet1</DataSetName>
        <Height>0.43in</Height>
        <Width>6.375in</Width>
        <Style />
      </Tablix>
    </ReportItems>
    <Height>0.43in</Height>
    <Style />
  </Body>
  <Width>6.375in</Width>
  <Page>
    <LeftMargin>1in</LeftMargin>
    <RightMargin>1in</RightMargin>
    <TopMargin>1in</TopMargin>
    <BottomMargin>1in</BottomMargin>
    <Style />
  </Page>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="SAT">
      <DataSourceReference>SAT</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>97a5c8d0-f4d8-4048-bd45-d00c39f51775</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet1">
      <Query>
        <DataSourceName>SAT</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@dt1">
            <Value>=Parameters!dt1.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@dt2">
            <Value>=Parameters!dt2.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>DECLARE @DTINICIAL DATETIME
DECLARE @DTFINAL DATETIME

SET		@DTINICIAL = Cast((cast(CAST(@dt1 AS DATE) as varchar) + ' 00:00:00.000') as datetime)
SET		@DTFINAL = Cast((cast(CAST(@dt2 AS DATE) as varchar) + ' 23:59:59.999') as datetime)

SELECT			CAST(Ano AS VARCHAR) + CAST(DBO.insertZero(Mes,2) AS VARCHAR) AS AnoMes, 
				Filial, SUM(ChamadosAbertos) AS ChamadosAbertos,
				SUM(ChamadosFechados) AS ChamadosFechados,	SUM(Atendimentos) AS Atendimentos
FROM			(
					SELECT				YEAR(OS.DataHoraAberturaOS) AS Ano,
										MONTH(OS.DataHoraAberturaOS) AS Mes,
										Filial.NomeFilial AS Filial,
										COUNT(Distinct OS.CodOS) AS ChamadosAbertos,
										0 AS ChamadosFechados,
										0 AS Atendimentos
					FROM			    OS
					LEFT OUTER JOIN		Filial ON OS.CodFilial = Filial.CodFilial
					WHERE				OS.CodStatusServico &lt;&gt; 2	
					--AND					OS.CodTipoIntervencao = 4
					AND					OS.CodFilial NOT IN (7, 21)
					AND					OS.DataHoraAberturaOS &gt;= @DTINICIAL
					AND					OS.DataHoraAberturaOS &lt;= @DTFINAL
					AND					OS.CodAutorizada in (select codAutorizada from Autorizada where RazaoSocial like 'PERTO AT%' and IndAtivo = 1 and NomeFantasia like 'P%')
					AND					OS.CodOS NOT IN 
										(
											SELECT				Distinct OS.CodOS
											FROM			    OS
											WHERE				OS.CodStatusServico &lt;&gt; 2	
											--AND					OS.CodTipoIntervencao = 4
											AND					OS.CodFilial NOT IN (7, 21)
											AND					OS.DataHoraAberturaOS &gt;= @DTINICIAL
											AND					OS.DataHoraAberturaOS &lt;= @DTFINAL
											AND					OS.CodAutorizada = 8
											AND					OS.CodEquip IN 
																		(
																				SELECT			CodEquip 
																				FROM			Equipamento 
																				WHERE			NomeEquip LIKE 'POS%'
																				OR				NomeEquip LIKE 'PERTOS%'
																		)
										)
					GROUP BY			YEAR(OS.DataHoraAberturaOS), MONTH(OS.DataHoraAberturaOS), Filial.NomeFilial 
					UNION
					SELECT				YEAR(OS.DataHoraFechamento) AS Ano,
										MONTH(OS.DataHoraFechamento) AS Mes,
										Filial.NomeFilial AS Filial,
										0 AS ChamadosAbertos,
										COUNT(Distinct OS.CodOS) AS ChamadosFechados,
										0 AS Atendimentos
					FROM			    OS
					LEFT OUTER JOIN		Filial ON OS.CodFilial = Filial.CodFilial
					WHERE				OS.CodStatusServico &lt;&gt; 2	
					--AND					OS.CodTipoIntervencao = 4					
					AND					OS.CodFilial NOT IN (7, 21)
					AND					OS.DataHoraFechamento &gt;= @DTINICIAL
					AND					OS.DataHoraFechamento &lt;= @DTFINAL
					AND					OS.CodAutorizada in (select codAutorizada from Autorizada where RazaoSocial like 'PERTO AT%' and IndAtivo = 1 and NomeFantasia like 'P%')
					AND					OS.CodOS NOT IN 
										(
											SELECT				Distinct OS.CodOS
											FROM			    OS
											WHERE				OS.CodStatusServico &lt;&gt; 2	
											--AND					OS.CodTipoIntervencao = 4
											AND					OS.CodFilial NOT IN (7, 21)
											AND					OS.DataHoraAberturaOS &gt;= @DTINICIAL
											AND					OS.DataHoraAberturaOS &lt;= @DTFINAL
											AND					OS.CodAutorizada = 8
											AND					OS.CodEquip IN 
																		(
																				SELECT			CodEquip 
																				FROM			Equipamento 
																				WHERE			NomeEquip LIKE 'POS%'
																				OR				NomeEquip LIKE 'PERTOS%'
																		)
										)
					GROUP BY			YEAR(OS.DataHoraFechamento), MONTH(OS.DataHoraFechamento), Filial.NomeFilial
					UNION
					SELECT				YEAR(RAT.DataHoraSolucao) AS Ano,
										MONTH(RAT.DataHoraSolucao) AS Mes,
										Filial.NomeFilial AS Filial,
										0 AS ChamadosAbertos,
										0 AS ChamadosFechados,
										COUNT(Distinct RAT.CodRAT) AS Atendimentos
					FROM			    OS
					INNER JOIN			RAT ON OS.CODOS = RAT.CODOS
					LEFT OUTER JOIN		Filial ON OS.CodFilial = Filial.CodFilial
					WHERE				OS.CodStatusServico &lt;&gt; 2	
					--AND					OS.CodTipoIntervencao = 4					
					AND					OS.CodFilial NOT IN (7, 21)
					AND					RAT.DataHoraSolucao &gt;= @DTINICIAL
					AND					RAT.DataHoraSolucao &lt;= @DTFINAL
					AND					OS.CodAutorizada in (select codAutorizada from Autorizada where RazaoSocial like 'PERTO AT%' and IndAtivo = 1 and NomeFantasia like 'P%')
					AND					OS.CodOS NOT IN 
										(
											SELECT				Distinct OS.CodOS
											FROM			    OS
											WHERE				OS.CodStatusServico &lt;&gt; 2	
											--AND					OS.CodTipoIntervencao = 4
											AND					OS.CodFilial NOT IN (7, 21)
											AND					OS.DataHoraAberturaOS &gt;= @DTINICIAL
											AND					OS.DataHoraAberturaOS &lt;= @DTFINAL
											AND					OS.CodAutorizada = 8
											AND					OS.CodEquip IN 
																		(
																				SELECT			CodEquip 
																				FROM			Equipamento 
																				WHERE			NomeEquip LIKE 'POS%'
																				OR				NomeEquip LIKE 'PERTOS%'
																		)
										)
					GROUP BY			YEAR(RAT.DataHoraSolucao), MONTH(RAT.DataHoraSolucao), Filial.NomeFilial
				) AS Dados
GROUP BY		Ano, Mes, Filial
ORDER BY		Ano, Mes, Filial</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="AnoMes">
          <DataField>AnoMes</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Filial">
          <DataField>Filial</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ChamadosAbertos">
          <DataField>ChamadosAbertos</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="ChamadosFechados">
          <DataField>ChamadosFechados</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Atendimentos">
          <DataField>Atendimentos</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="dt1">
      <DataType>DateTime</DataType>
      <Prompt>Data Inicial:</Prompt>
    </ReportParameter>
    <ReportParameter Name="dt2">
      <DataType>DateTime</DataType>
      <Prompt>Data Final</Prompt>
    </ReportParameter>
  </ReportParameters>
  <Language>en-US</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>f050e3d9-4414-4c16-9474-87ccccbf36bd</rd:ReportID>
</Report>